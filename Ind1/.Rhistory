shiny::runApp()
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs8')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs7')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs6')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs5')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs1')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs1')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs1')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs1')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs1')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
ant_en_col<-function(Año = NULL, Mes = NULL, Producto = NULL){
df<-antioquia
# Año seleccionado
if (!is.null(Año)) {
df <- df %>% dplyr::filter(anio == Año)
}
# Mes seleccionado, si se proporciona
if (!is.null(Mes)) {
df <- df %>% dplyr::filter(mes == Mes)
}
# Si se especifica un producto
if (!is.null(Producto)) {
df <- df %>% dplyr::filter(producto == Producto)
}
if (!is.null(Año) && !is.null(Mes) && !is.null(Producto)) {
df<- df  %>%
distinct(anio,depto_origen,producto,mes, .keep_all = TRUE) %>%
select(anio,depto_origen, mes, producto, porcentaje_dpto_mes_producto)
df <- df %>% rename( columna_porcentaje = porcentaje_dpto_mes_producto)
} else if (!is.null(Año) && !is.null(Mes)) {
df<- df  %>%
distinct(anio,depto_origen,mes, .keep_all = TRUE) %>%
select(anio,depto_origen, mes, porcentaje_dpto_mes)
columna_porcentaje <- "porcentaje_dpto_mes"
df <- df %>% rename( columna_porcentaje = porcentaje_dpto_mes)
} else if (!is.null(Año) && !is.null(Producto)) {
df<- df  %>%
distinct(anio,depto_origen,producto, .keep_all = TRUE) %>%
select(anio,depto_origen, producto, porcentaje_dpto_anio_producto)
columna_porcentaje <- "porcentaje_dpto_anio_producto"
df <- df %>% rename( columna_porcentaje =porcentaje_dpto_anio_producto)
} else if (!is.null(Año)){
# No se tienen ni mes ni producto
df<- df  %>%
distinct(anio,depto_origen, .keep_all = TRUE) %>%
select(anio,depto_origen, porcentaje_dpto_anio)
df <- df %>% rename( columna_porcentaje = porcentaje_dpto_anio)
}else if (!is.null(Producto)){
# No se tienen ni mes ni producto
df<- df  %>%
distinct(depto_origen,producto, .keep_all = TRUE) %>%
select(depto_origen,producto, porcentaje_dpto_prod)
df <- df %>% rename( columna_porcentaje = porcentaje_dpto_prod)
} else {
df<- df  %>%
distinct(depto_origen, .keep_all = TRUE) %>%
select(depto_origen, porcentaje_dpto)
df <- df %>% rename( columna_porcentaje = porcentaje_dpto)
}
df<-df#%>%filter(depto_origen !="ANTIOQUIA")
mapa<-shapefile%>%dplyr::left_join(df, by = c("dpto_cnmbr"="depto_origen"))%>%
mutate(columna_porcentaje=columna_porcentaje*100)
# Crear un título dinámico
#titulo <- paste("Porcentaje que se envía a Antioquia", ifelse(is.null(Año), "", paste("en el año", Año)),
#                ifelse(is.null(Mes), "", paste("para el mes", Mes)),
#                ifelse(is.null(Producto), "", paste("-", Producto)))
# Filtrar para eliminar las filas con valores NA en "comp"
mapa <- mapa %>% #filter(!is.na(columna_porcentaje))%>%
arrange(columna_porcentaje)%>%mutate(columna_porcentaje2=columna_porcentaje*-1)
min_val <- min(abs(na.omit(mapa$columna_porcentaje)))
max_val <- max(abs(na.omit(mapa$columna_porcentaje)))
valores_sin_na <- na.omit(mapa$columna_porcentaje)
my_palette_sin_na <- colorNumeric(palette = c("#F2E203", "#1A4922"), domain = valores_sin_na)
# Crear una paleta de colores personalizada
my_palette <- colorNumeric(palette = colorRampPalette(c("#F2E203", "#1A4922"))(length(unique(mapa$columna_porcentaje))), domain = c(min_val,max_val),  na.color = "#C5C7C6")
# Crear el mapa interactivo
p <- leaflet(mapa) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(fillColor = ~my_palette(columna_porcentaje),
fillOpacity = 0.8,
color = "#D5D5D5",
weight = 1,
popup = ~paste0("<strong>Departamento: </strong>", dpto_cnmbr,
"<br><strong>Diferencia del precio: </strong>", round(columna_porcentaje),"%"),
highlightOptions = highlightOptions(color = "white",
weight = 2,
bringToFront = FALSE)) %>%
addLegend(pal = my_palette_sin_na, values = ~valores_sin_na, opacity = 0.7, title = "Porcentaje")#, na.label = "")
porcentaje_max <- round(max(df$columna_porcentaje) * 100)
dpto_max <- df$depto_origen[which.max(df$columna_porcentaje)][df$depto_origen!="ANTIOQUIA"]
dpto_max <- tolower(dpto_max)
words <- strsplit(dpto_max, " ")[[1]]
words <- paste(toupper(substring(words, 1, 1)), substring(words, 2), sep = "")
dpto_max <- paste(words, collapse = " ")
return(list(
grafico = p,
datos = df,
porcentaje_max = porcentaje_max,
dpto_max = dpto_max
))
}
ant_en_col()
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs2')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs5')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs5')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs5')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs5')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs5')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs5')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs6')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs6')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs6')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs6')
runApp()
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs6')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Pre3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Pre3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Pre3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Pre3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Pre3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Ind4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Pre3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Pre3')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs1')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs4')
runApp('C:/Users/user/OneDrive - Universidad EAFIT/FAO_Tableros/Abs1')
